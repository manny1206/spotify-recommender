(this.webpackJsonphw4=this.webpackJsonphw4||[]).push([[0],{103:function(e,t,n){},122:function(e,t){},164:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(25),i=n.n(r),s=(n(103),n(104),n(12)),o=n(208),u=n(203),l=n(75),j=n.n(l),d=n(33),h=n.n(d);var f=n(2);function b(e){var t=e.track,n=e.playTrack;return Object(f.jsxs)("div",{className:"d-flex m-2 align-items-center",style:{cursor:"pointer"},onClick:function(){n(t)},children:[Object(f.jsx)("img",{src:t.albumUrl,style:{height:"64px",width:"64px"}}),Object(f.jsxs)("div",{className:"ml-3",children:[Object(f.jsx)("h1",{children:t.title}),Object(f.jsx)("h2",{className:"text-muted",children:t.artist})]})]})}var m=n(86);function O(e){var t=e.accessToken,n=e.trackUri,a=Object(c.useState)(!1),r=Object(s.a)(a,2),i=r[0],o=r[1];return Object(c.useEffect)((function(){o(!0)}),[n]),Object(f.jsx)(f.Fragment,{children:t&&Object(f.jsx)(m.a,{showSaveIcon:!0,token:t,uris:n?[n]:[],play:i,callback:function(e){e.isPlaying||o(!1)}})})}var x=n(207),p=n(209),g=n(213),v=n(212),y=n(214),k=n(211);function S(e){var t=e.track,n=e.playTrack;return Object(f.jsx)(p.a,{sx:{maxWidth:128},onClick:function(){n(t)},children:Object(f.jsxs)(k.a,{children:[Object(f.jsx)(v.a,{component:"img",height:"128",image:t.album.images.reduce((function(e,t){return t.height>e.height?t:e}),t.album.images[0]).url,alt:"Album Cover"}),Object(f.jsxs)(g.a,{children:[Object(f.jsx)(y.a,{gutterBottom:!0,variant:"subtitle1",component:"div",children:t.name.length<22?t.name:t.name.substring(0,22)+"..."}),Object(f.jsx)(y.a,{variant:"subtitle2",color:"text.secondary",children:t.artists[0].name})]})]})})}function w(e){var t=e.recommendations,n=e.playTrack,a=Object(c.useState)([]),r=Object(s.a)(a,2),i=r[0],u=r[1];return Object(c.useEffect)((function(){t&&u(t)}),[t]),Object(f.jsx)(o.a,{maxWidth:"md",style:{minHeight:"100%"},children:Object(f.jsxs)(x.a,{container:!0,spacing:1,rowSpacing:.5,columns:4,children:[Object(f.jsx)(x.a,{item:!0,xs:12,style:{textAlign:"center",fontSize:"30px"},children:"Song Recommendations"}),i.map((function(e){return Object(f.jsx)(x.a,{item:!0,children:Object(f.jsx)(S,{track:e,playTrack:n},e.external_urls.spotify)})}))]})})}var T=new j.a({clientId:"fc40f86251ce4a378422d00d57473fa1"});function I(e){var t=function(e){var t=Object(c.useState)(),n=Object(s.a)(t,2),a=n[0],r=n[1],i=Object(c.useState)(),o=Object(s.a)(i,2),u=o[0],l=o[1],j=Object(c.useState)(),d=Object(s.a)(j,2),f=d[0],b=d[1];return Object(c.useEffect)((function(){h.a.post("/authServer/login",{code:e}).then((function(e){r(e.data.accessToken),l(e.data.refreshToken),b(e.data.expiresIn),window.history.pushState({},null,"/")})).catch((function(){window.location="/"}))}),[e]),Object(c.useEffect)((function(){if(u&&f){var e=setInterval((function(){h.a.post("/authServer/refresh",{refreshToken:u}).then((function(e){r(e.data.accessToken),b(e.data.expiresIn),window.history.pushState({},null,"/")})).catch((function(){window.location="/"}))}),1e3*(f-60));return function(){return clearInterval(e)}}}),[u,f]),a}(e.code),n=Object(c.useState)(""),a=Object(s.a)(n,2),r=a[0],i=a[1],l=Object(c.useState)([]),j=Object(s.a)(l,2),d=j[0],m=j[1],x=Object(c.useState)(),p=Object(s.a)(x,2),g=p[0],v=p[1],y=Object(c.useState)([]),k=Object(s.a)(y,2),S=k[0],I=k[1];Object(c.useEffect)((function(){t&&(T.setAccessToken(t),h.a.get("/recommenderServer/recommend?token=".concat(t)).then((function(e){return I(e.data.tracks)})))}),[t]),Object(c.useEffect)((function(){if(t){if(!r)return m([]);var e=!1;return T.searchTracks(r).then((function(t){e||m(t.body.tracks.items.map((function(e){var t=e.album.images.reduce((function(e,t){return t.height<e.height?t:e}),e.album.images[0]);return{artist:e.artists[0].name,title:e.name,uri:e.uri,albumUrl:t.url}})))})),function(){return e=!0}}}),[r,t]);var C=function(e){v(e),i("")};return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(o.a,{className:"d-flex flex-column py-2",style:{height:"100vh"},children:[Object(f.jsx)(u.a,{fullWidth:!0,margin:"normal",label:"Search Songs/Artists",value:r,onChange:function(e){return i(e.target.value)}}),Object(f.jsxs)("div",{className:"flex-grow-1 my-2",style:{overflowY:"auto"},children:[d.map((function(e){return Object(f.jsx)(b,{track:e,playTrack:C},e.url)})),0===d.length&&Object(f.jsx)(w,{recommendations:S,playTrack:C})]}),Object(f.jsx)("div",{children:Object(f.jsx)(O,{accessToken:t,trackUri:null===g||void 0===g?void 0:g.uri})})]})})}var C=n(206),E="https://accounts.spotify.com/authorize?client_id=".concat("fc40f86251ce4a378422d00d57473fa1","&response_type=code&redirect_uri=").concat("http://localhost:3000","&scope=").concat("streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state%20user-top-read%20user-read-recently-played");function N(){return Object(f.jsxs)("div",{style:{margin:0,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[Object(f.jsx)(y.a,{className:"row justify-content-center",variant:"h2",children:"Spotify Recommender!"}),Object(f.jsx)(o.a,{className:"d-flex justify-content-center",maxWidth:"sm",style:{minHeight:"100%"},children:Object(f.jsx)(C.a,{variant:"contained",color:"success",style:{borderRadius:50},href:E,children:"Login With Spotify"})})]})}var F=new URLSearchParams(window.location.search).get("code");var U=function(){return F?Object(f.jsx)(I,{code:F}):Object(f.jsx)(N,{})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,215)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};i.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(U,{})}),document.getElementById("root")),W()}},[[164,1,2]]]);
//# sourceMappingURL=main.310ada40.chunk.js.map